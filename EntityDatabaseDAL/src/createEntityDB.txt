/*
Script generated by Aqua Data Studio 8.0.24 on May-02-2011 02:02:41 AM
Database: entitydb
Schema: <All Schemas>
Objects: TABLE
*/
ALTER TABLE "users"
	DROP FOREIGN KEY "FK_USERENTITYID"
GO
ALTER TABLE "usergroupmembership"
	DROP FOREIGN KEY "FK_UGM_USERID"
GO
ALTER TABLE "usergroupmembership"
	DROP FOREIGN KEY "FK_UGM_GROUPID"
GO
ALTER TABLE "systemlog"
	DROP FOREIGN KEY "FK_SL_USERID"
GO
ALTER TABLE "systemlog"
	DROP FOREIGN KEY "FK_SL_ENTITYID"
GO
ALTER TABLE "people"
	DROP FOREIGN KEY "FK_ENTITYID"
GO
ALTER TABLE "location"
	DROP FOREIGN KEY "FK_LOCATION_ENTITYID"
GO
ALTER TABLE "event"
	DROP FOREIGN KEY "FK_EVENT_ENTITYID"
GO
ALTER TABLE "entitytext"
	DROP FOREIGN KEY "FK_ET_ENTITYID"
GO
ALTER TABLE "entityrelationship"
	DROP FOREIGN KEY "FK_ER_PARENT"
GO
ALTER TABLE "entityrelationship"
	DROP FOREIGN KEY "FK_ER_EROLEID"
GO
ALTER TABLE "entityrelationship"
	DROP FOREIGN KEY "FK_ER_CHILE"
GO
ALTER TABLE "entitymetadata"
	DROP FOREIGN KEY "FK_EM_ENTITYID"
GO
ALTER TABLE "users"
	DROP INDEX "UserEmail"
GO
DROP INDEX "FK_UGM_GROUPID" ON usergroupmembership
GO
DROP INDEX "FK_SL_ENTITYID" ON systemlog
GO
DROP INDEX "FK_SL_USERID" ON systemlog
GO
DROP INDEX "FK_ER_CHILE" ON entityrelationship
GO
DROP INDEX "FK_ER_EROLEID" ON entityrelationship
GO
DROP TABLE "users"
GO
DROP TABLE "usergroupmembership"
GO
DROP TABLE "systemperms"
GO
DROP TABLE "systemlog"
GO
DROP TABLE "people"
GO
DROP TABLE "location"
GO
DROP TABLE "grouptype"
GO
DROP TABLE "groups"
GO
DROP TABLE "grouproleperm"
GO
DROP TABLE "grouprolelist"
GO
DROP TABLE "event"
GO
DROP TABLE "entitytype"
GO
DROP TABLE "entitytexttype"
GO
DROP TABLE "entitytext"
GO
DROP TABLE "entityrole"
GO
DROP TABLE "entityrelationship"
GO
DROP TABLE "entitymetadata"
GO
DROP TABLE "entitybase"
GO

CREATE TABLE "entitybase"  ( 
	"EntityID"          	varchar(40) NOT NULL,
	"EntityTypeID"      	int(11) NULL,
	"EntityAccessStatus"	varchar(20) NULL,
	"EntityParentEdit"  	varchar(20) NULL,
	"OwnerID"           	varchar(40) NULL,
	PRIMARY KEY("EntityID")
)
GO
CREATE TABLE "entitymetadata"  ( 
	"EntityID"  	varchar(40) NOT NULL,
	"MetadataID"	int(11) NOT NULL,
	PRIMARY KEY("EntityID","MetadataID")
)
GO
CREATE TABLE "entityrelationship"  ( 
	"ParentEntityID"	varchar(40) NOT NULL,
	"ChildEntityID" 	varchar(40) NOT NULL,
	"EntityRoleID"  	int(11) NULL,
	PRIMARY KEY("ParentEntityID","ChildEntityID")
)
GO
CREATE TABLE "entityrole"  ( 
	"EntityRoleID"  	int(11) NOT NULL,
	"EntityRoleDesc"	varchar(100) NULL,
	PRIMARY KEY("EntityRoleID")
)
GO
CREATE TABLE "entitytext"  ( 
	"EntityID"        	varchar(40) NOT NULL,
	"EntityText"      	varchar(20) NULL,
	"EntityTextTypeID"	int(11) NOT NULL,
	PRIMARY KEY("EntityID")
)
GO
CREATE TABLE "entitytexttype"  ( 
	"EntityTextTypeID"  	int(11) NOT NULL,
	"EntityTextTypeDesc"	varchar(100) NULL,
	PRIMARY KEY("EntityTextTypeID")
)
GO
CREATE TABLE "entitytype"  ( 
	"EntityTypeID"  	int(11) NOT NULL,
	"EntityTypeDesc"	varchar(100) NULL,
	PRIMARY KEY("EntityTypeID")
)
GO
CREATE TABLE "event"  ( 
	"EntityID"      	varchar(40) NOT NULL,
	"EventStartDate"	datetime NOT NULL,
	"EventEndDate"  	datetime NULL,
	PRIMARY KEY("EntityID")
)
GO
CREATE TABLE "grouprolelist"  ( 
	"GroupRoleID"	int(11) NOT NULL,
	"RoleDesc"   	varchar(100) NULL,
	PRIMARY KEY("GroupRoleID")
)
GO
CREATE TABLE "grouproleperm"  ( 
	"EntityTypeID"     	int(11) NOT NULL,
	"UserGroupRoleID"  	int(11) NOT NULL,
	"UserRolePerm"     	varchar(20) NULL,
	"UserRolePermAllow"	varchar(20) NULL,
	PRIMARY KEY("EntityTypeID")
)
GO
CREATE TABLE "groups"  ( 
	"GroupID"          	int(11) NOT NULL,
	"GroupTypeID"      	int(11) NOT NULL,
	"GroupAccessStatus"	varchar(20) NULL,
	"GroupUserPerm"    	varchar(20) NULL,
	"GroupGroupPerm"   	varchar(20) NULL,
	"GroupAllPerm"     	varchar(20) NULL,
	PRIMARY KEY("GroupID")
)
GO
CREATE TABLE "grouptype"  ( 
	"GroupTypeID"  	int(11) NOT NULL,
	"GroupTypeDesc"	varchar(100) NULL,
	PRIMARY KEY("GroupTypeID")
)
GO
CREATE TABLE "location"  ( 
	"EntityID"     	varchar(40) NOT NULL,
	"Latitude"     	varchar(20) NULL,
	"Longitude"    	varchar(20) NULL,
	"StreetAddress"	varchar(100) NULL,
	PRIMARY KEY("EntityID")
)
GO
CREATE TABLE "people"  ( 
	"EntityID"       	varchar(40) NOT NULL,
	"PeopleFirstName"	varchar(50) NULL,
	"PeopleLastName" 	varchar(50) NULL,
	"PeopleEmail"    	varchar(100) NULL,
	"PeoplePhone"    	varchar(20) NULL,
	PRIMARY KEY("EntityID")
)
GO
CREATE TABLE "systemlog"  ( 
	"SystemLogID"        	int(11) NOT NULL,
	"UserID"             	varchar(40) NULL,
	"SystemLogAction"    	varchar(20) NULL,
	"SystemLogActionDate"	date NULL,
	"EntityID"           	varchar(40) NULL,
	"SystemLogMisc"      	varchar(100) NULL,
	PRIMARY KEY("SystemLogID")
)
GO
CREATE TABLE "systemperms"  ( 
	"EntityTypeID"     	int(11) NOT NULL,
	"SystemPermsOwner" 	varchar(20) NULL,
	"SystemPermsGroup" 	varchar(20) NULL,
	"SystemPermsOthers"	varchar(20) NULL,
	PRIMARY KEY("EntityTypeID")
)
GO
CREATE TABLE "usergroupmembership"  ( 
	"UserID"         	varchar(40) NOT NULL,
	"GroupID"        	int(11) NOT NULL,
	"UserGroupRoleID"	int(11) NULL,
	PRIMARY KEY("UserID","GroupID")
)
GO
CREATE TABLE "users"  ( 
	"EntityID"        	varchar(40) NOT NULL,
	"UserEmail"       	varchar(100) NULL,
	"UserSalt"        	varchar(20) NULL,
	"UserPasswordHash"	varchar(64) NULL,
	"UserOauthToken"  	varchar(20) NULL,
	PRIMARY KEY("EntityID")
)
GO

CREATE INDEX "FK_ER_CHILE"
	ON "entityrelationship"("ChildEntityID")
GO
CREATE INDEX "FK_ER_EROLEID"
	ON "entityrelationship"("EntityRoleID")
GO
CREATE INDEX "FK_SL_ENTITYID"
	ON "systemlog"("EntityID")
GO
CREATE INDEX "FK_SL_USERID"
	ON "systemlog"("UserID")
GO
CREATE INDEX "FK_UGM_GROUPID"
	ON "usergroupmembership"("GroupID")
GO
ALTER TABLE "users"
	ADD CONSTRAINT "UserEmail"
	UNIQUE ("UserEmail")
GO
ALTER TABLE "entitymetadata"
	ADD CONSTRAINT "FK_EM_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "entityrelationship"
	ADD CONSTRAINT "FK_ER_PARENT"
	FOREIGN KEY("ParentEntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "entityrelationship"
	ADD CONSTRAINT "FK_ER_EROLEID"
	FOREIGN KEY("EntityRoleID")
	REFERENCES "entityrole"("EntityRoleID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "entityrelationship"
	ADD CONSTRAINT "FK_ER_CHILE"
	FOREIGN KEY("ChildEntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "entitytext"
	ADD CONSTRAINT "FK_ET_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "event"
	ADD CONSTRAINT "FK_EVENT_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "location"
	ADD CONSTRAINT "FK_LOCATION_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "people"
	ADD CONSTRAINT "FK_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "systemlog"
	ADD CONSTRAINT "FK_SL_USERID"
	FOREIGN KEY("UserID")
	REFERENCES "users"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "systemlog"
	ADD CONSTRAINT "FK_SL_ENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "entitybase"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "usergroupmembership"
	ADD CONSTRAINT "FK_UGM_USERID"
	FOREIGN KEY("UserID")
	REFERENCES "users"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "usergroupmembership"
	ADD CONSTRAINT "FK_UGM_GROUPID"
	FOREIGN KEY("GroupID")
	REFERENCES "groups"("GroupID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
ALTER TABLE "users"
	ADD CONSTRAINT "FK_USERENTITYID"
	FOREIGN KEY("EntityID")
	REFERENCES "people"("EntityID")
	ON DELETE RESTRICT 
	ON UPDATE RESTRICT 
GO
